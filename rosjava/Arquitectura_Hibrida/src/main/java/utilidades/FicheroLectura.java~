package utilidades;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileNotFoundException;
import java.io.IOException;

/**
 * Clase auxiliar que representa un fichero tratado en modo lectura.
 * 
 * @author José Luis Díaz Cebrián
 * @version 1.0
 * 
 */
public class FicheroLectura{
    
    /**
     * Fichero abierto en modo lectura.
     */
    private BufferedReader _fichero;
    
    /**
     * Nombre del fichero.
     */
    private String _nombre;
    
    /**
     * Número de línea donde se encuentra la última lectura realizada.
     */
    private int _numLinea;
    
    
    /**
     * Constructor que recibe el nombre de un fichero para tratarlo en modo lectura.
     *  
     * @param nombreFichero Nombre del fichero a leer
     */
    public FicheroLectura(String nombreFichero){
        _nombre = new String(nombreFichero);
        _numLinea = 1;
    }
    
    
    /**
     * Método que abre el fichero en modo lectura. Si no es posible, devuelve el valor 
     * booleano "false".
     * 
     * @return "true" si se abre el fichero correctamente, "false" en caso contrario
     */
    public boolean abrir(){
        boolean exito;
        exito = false;
        try{
            _fichero = new BufferedReader(new FileReader(_nombre));
            exito = true;
        }catch(FileNotFoundException e){
            System.out.println("Fichero " + _nombre + " no encontrado");
        }
        return exito;
    }
    
    /**
     * Método que lee un carácter del fichero. En caso de llegar al final del fichero, devuelve 
     * un carácter en blanco.
     * 
     * @return El carácter leído del fichero
     */
    public char leerCaracter(){
        int caracter;
        caracter = 0;
        try{
            caracter = _fichero.read();
        }catch(IOException e){
            System.out.println("Error en la lectura del fichero " + _nombre);
        }
        if(caracter == '\n'){
            incrementarNumLinea();
        }
        //Si es final de fichero
        if(caracter == -1){
            return ' ';
        } else{
            return (char)caracter;
        }
    }
    
    /**
     * Método que lee una palabra. En caso de llegar al final del fichero, devuelve null.
     * 
     * @return La palabra leída del fichero
     */
    public String leerPalabra(){
        String palabra;
        int caracter;
        palabra = new String();
        try{
            caracter = _fichero.read();
            while((caracter != ' ') && (caracter != '\n') && (caracter != '\t') && 
            (caracter != '\r') && (caracter != -1)){
                palabra = palabra + (char)caracter;
                caracter = _fichero.read();
            }
            if(caracter == '\n'){
                incrementarNumLinea();
            }
            if(caracter == -1){
                palabra = null;
            }
        }catch(IOException e){
            System.out.println("Error en la lectura del fichero " + _nombre);
        }
        return palabra;
    }
    
    /**
     * Método que lee una línea del fichero.
     * 
     * @return La línea leída del fichero
     */
    public String leerLinea(){
        String linea;
        linea = new String();
        try{
            linea = _fichero.readLine();
            incrementarNumLinea();
        }catch(IOException e){
            System.out.println("Error en la lectura del fichero " + _nombre);
        }
        return linea;
    }
    
    /**
     * Método que cierra el fichero.
     * 
     * @return "true" si se cierra el fichero correctamente, "false" en caso contrario
     */
    public boolean cerrar(){
        boolean exito;
        exito = false;
        try{
            _fichero.close();
            exito = true;
        }catch(IOException e){
            System.out.println("Error al cerrar el fichero " + _nombre);
        }
        return exito;
    }
    
    /**
     * Método que incrementa en una unidad el número de línea.
     */
    public void incrementarNumLinea(){
        _numLinea++;
    }
    
    /**
     * Método que devuelve el número de línea actual.
     * 
     * @return El número de línea por la que se va leyendo
     */
    public  int obtenerNumLinea(){
        return _numLinea;
    }
    
}

